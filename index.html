<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Sistema Gamer</title>

<style>
body{
  margin:0;
  font-family:Arial;
  background:#0b1020;
  color:#fff;
}
.screen{
  display:none;
  min-height:100vh;
  align-items:center;
  justify-content:center;
}
.active{display:flex}
.box{
  background:#06172f;
  width:420px;
  padding:15px;
  border-radius:12px;
  text-align:center;
}
.menu{
  display:flex;
  gap:5px;
  flex-wrap:wrap;
  margin-bottom:10px;
}
.menu button{
  flex:1;
  background:#1e4fff;
}
.section{display:none}
.section.active{display:block}

.avatar{
  width:100px;height:100px;
  border-radius:50%;
  background:#333;
  margin:10px auto;
  border:5px solid transparent;
  overflow:hidden;
}
.avatar img{
  width:100%;
  height:100%;
  object-fit:cover;
}

.border{
  width:45px;height:45px;
  border-radius:50%;
  border:5px solid;
  cursor:pointer;
}

input,button{
  width:100%;
  padding:8px;
  margin-top:6px;
  border:none;
  border-radius:6px;
}
button{background:#1e4fff;color:white}

.inventory,.borders{
  display:flex;
  gap:8px;
  justify-content:center;
  flex-wrap:wrap;
}

#admBtn{
  position:fixed;
  right:10px;
  top:50%;
  transform:translateY(-50%);
  background:#ff4444;
  padding:10px;
  border-radius:8px;
  cursor:pointer;
}
#admPanel{
  position:fixed;
  right:80px;
  top:50%;
  transform:translateY(-50%);
  background:#020a18;
  padding:15px;
  width:260px;
  border-radius:10px;
  display:none;
}

.rank{
  background:#020a18;
  padding:6px;
  margin:4px 0;
  border-radius:5px;
}
</style>
</head>

<body>

<!-- LOGIN -->
<div class="screen active" id="loginScreen">
  <div class="box">
    <h2>Login</h2>
    <input id="loginName" placeholder="Nome">
    <input id="loginPass" type="password" placeholder="Senha">
    <button onclick="login()">Entrar</button>
    <button onclick="showRegister()">Registrar</button>
  </div>
</div>

<!-- REGISTRO -->
<div class="screen" id="registerScreen">
  <div class="box">
    <h2>Registro</h2>
    <input id="regName" placeholder="Nome">
    <input id="regPass" type="password" placeholder="Senha">
    <button onclick="register()">Criar conta</button>
    <button onclick="backLogin()">Voltar</button>
  </div>
</div>

<!-- JOGO -->
<div class="screen" id="gameScreen">
  <div class="box">

    <div class="menu">
      <button onclick="openSec('perfil')">Perfil</button>
      <button onclick="openSec('loja')">Loja</button>
      <button onclick="openSec('inventario')">InventÃ¡rio</button>
      <button onclick="openSec('premium')">Premium</button>
      <button onclick="openSec('foto')">Foto</button>
      <button onclick="openSec('ranking')">Ranking</button>
      <button onclick="openSec('apps')">ðŸŽ® Jogos</button>
    </div>

    <!-- PERFIL -->
    <div class="section active" id="perfil">
      <div class="avatar" id="avatar"></div>
      <h3 id="nome"></h3>
      <p>ðŸ’° Dinheiro do site: <span id="coins"></span></p>

      <input id="valorResgate" type="number" placeholder="Valor para resgatar">
      <button onclick="resgatar()">ðŸ’¸ Resgatar</button>
      <p id="msgResgate"></p>

      <p id="status"></p>
      <p id="device"></p>
    </div>

    <!-- LOJA -->
    <div class="section" id="loja">
      <div class="borders">
        <div class="border" style="border-color:gold" onclick="buyBorder('gold')"></div>
        <div class="border" style="border-color:#00aaff" onclick="buyBorder('#00aaff')"></div>
        <div class="border" style="border-color:#ff4444" onclick="buyBorder('#ff4444')"></div>
      </div>
    </div>

    <!-- INVENTÃRIO -->
    <div class="section" id="inventario">
      <div class="inventory" id="inv"></div>
    </div>

    <!-- PREMIUM -->
    <div class="section" id="premium">
      <button onclick="buyPremium()">Ativar Premium</button>
    </div>

    <!-- FOTO -->
    <div class="section" id="foto">
      <input type="file" accept="image/*" onchange="setPhoto(event)">
    </div>

    <!-- RANKING -->
    <div class="section" id="ranking">
      <div id="rankList"></div>
    </div>

  </div>
</div>

<!-- ADM -->
<div id="admBtn" style="display:none" onclick="toggleAdm()">ADM</div>

<div id="admPanel">
  <h3>Gerar cÃ³digo</h3>
  <input id="moneyValue" type="number" placeholder="Valor">
  <button onclick="generateCode()">Gerar</button>
  <p id="moneyCode"></p>
</div>

<script>
const ADM_NAME="Rodolfo";
const ADM_PASS="rodolfo408*";

let players = JSON.parse(localStorage.getItem("playersDB")||"[]");
let moneyCodes = JSON.parse(localStorage.getItem("moneyCodes")||"{}");
let user = null;

// AUTO LOGIN
let saved = localStorage.getItem("user");
if(saved){
  user = JSON.parse(saved);
  start();
}

function detectDevice(){
  return /mobile/i.test(navigator.userAgent)?"ðŸ“± Mobile":"ðŸ’» PC";
}

function showRegister(){
  loginScreen.classList.remove("active");
  registerScreen.classList.add("active");
}
function backLogin(){
  registerScreen.classList.remove("active");
  loginScreen.classList.add("active");
}

// REGISTRO
function register(){
  if(players.find(p=>p.name===regName.value)){
    alert("Nome jÃ¡ existe");return;
  }
  user={
    name:regName.value,
    pass:regPass.value,
    coins:"0",
    premium:false,
    admin:false,
    inventory:[],
    photo:null,
    device:detectDevice()
  };
  players.push(user);
  saveAll();
  start();
}

// LOGIN
function login(){
  if(loginName.value===ADM_NAME && loginPass.value===ADM_PASS){
    user={
      name:ADM_NAME,
      coins:"0",
      premium:false,
      admin:true,
      inventory:[],
      photo:null,
      device:detectDevice()
    };
    saveAll();
    start();
    return;
  }
  let u=players.find(p=>p.name===loginName.value && p.pass===loginPass.value);
  if(!u){alert("Login invÃ¡lido");return;}
  user=u;
  start();
}

function start(){
  loginScreen.classList.remove("active");
  registerScreen.classList.remove("active");
  gameScreen.classList.add("active");

  nome.innerText=user.name;
  coins.innerText=user.coins;
  status.innerText=user.admin?"ðŸ‘‘ ADM":user.premium?"ðŸ’Ž Premium":"Jogador";
  device.innerText=user.device;

  if(user.photo) avatar.innerHTML=`<img src="${user.photo}">`;
  if(user.equipped) avatar.style.borderColor=user.equipped;
  if(user.admin) admBtn.style.display="block";

  saveAll();
}

function openSec(id){
  if(id==="apps"){window.location.href="painel.html";return;}
  document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
  if(id==="inventario") renderInv();
  if(id==="ranking") renderRank();
}

// BORDAS
function buyBorder(c){
  if(!user.inventory.includes(c)) user.inventory.push(c);
  user.equipped=c;
  avatar.style.borderColor=c;
  saveAll();
}
function renderInv(){
  inv.innerHTML="";
  user.inventory.forEach(b=>{
    let d=document.createElement("div");
    d.className="border";
    d.style.borderColor=b;
    d.onclick=()=>{user.equipped=b;avatar.style.borderColor=b;saveAll()};
    inv.appendChild(d);
  });
}

// PREMIUM
function buyPremium(){
  user.premium=true;
  saveAll();
}

// FOTO
function setPhoto(e){
  let r=new FileReader();
  r.onload=()=>{
    user.photo=r.result;
    avatar.innerHTML=`<img src="${r.result}">`;
    saveAll();
  }
  r.readAsDataURL(e.target.files[0]);
}

// RESGATE (BigInt)
function resgatar(){
  let msg=document.getElementById("msgResgate");
  let valor=document.getElementById("valorResgate").value;
  let saldo=BigInt(user.coins);

  if(!valor || BigInt(valor)<=0n){
    msg.innerText="Digite um valor vÃ¡lido";
    return;
  }
  if(BigInt(valor)>saldo){
    msg.innerText="VocÃª nÃ£o tem dinheiro suficiente.";
    return;
  }

  user.coins=(saldo-BigInt(valor)).toString();
  coins.innerText=user.coins;
  msg.style.color="lime";
  msg.innerText="Robux foi resgatado para sua conta, chegarÃ¡ daqui a um ano.";
  saveAll();
}

// ADM
function toggleAdm(){
  admPanel.style.display=admPanel.style.display==="block"?"none":"block";
}
function generateCode(){
  let v=moneyValue.value;
  let c="DIN-"+Math.random().toString(36).substr(2,6).toUpperCase();
  moneyCodes[c]=v;
  moneyCode.innerText=c;
  saveAll();
}

// RANKING
function renderRank(){
  rankList.innerHTML="";
  [...players].sort((a,b)=>BigInt(b.coins)-BigInt(a.coins))
    .forEach((p,i)=>{
      rankList.innerHTML+=`<div class="rank">${i+1}Âº ${p.name} - ðŸ’° ${p.coins}</div>`;
    });
}

// SAVE
function saveAll(){
  let i=players.findIndex(p=>p.name===user.name);
  if(i>=0) players[i]=user;
  else players.push(user);
  localStorage.setItem("playersDB",JSON.stringify(players));
  localStorage.setItem("user",JSON.stringify(user));
  localStorage.setItem("moneyCodes",JSON.stringify(moneyCodes));
}
</script>

</body>
</html>
